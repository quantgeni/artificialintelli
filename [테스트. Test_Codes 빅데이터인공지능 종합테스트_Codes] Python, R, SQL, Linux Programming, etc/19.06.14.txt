1번.
setwd('c:/Java/data')
diet <- read.csv('diet.txt', header=T, sep=' ')
diet
before <- diet$before
after <- diet$after

#정규성과 등분산성 만족 => t.test 유효
shapiro.test(before) #p-value 0.8318 정규성 만족 (귀무가설 [null hypothesis] 채택 - 즉, 대립가설 [alternative hypothesis] 기각)
shapiro.test(after) #p-value 0.7222 정규성 만족 (귀무가설 [null hypothesis] 채택 - 즉, 대립가설 [alternative hypothesis] 기각)
var.test(before, after) #p-value 0.9602 등분산성 만족 (귀무가설 [null hypothesis] 채택 - 즉, 대립가설 [alternative hypothesis] 기각)

#다이어트 관련이므로, 통상 대립가설은 몸무게를 less단측으로 검정하는
#"체중 평균이 감소한 정도성이 통계적으로 유의미하다"이겠으나,
#빠졌건 쪘건 그대로건, 평균 간 통계적으로 유의미한 차이 (significant difference)가 
#존재하는지 자체를 검증한다는 차원에서 greater단측이나 two.sided양측 t.test 또한
#시행 시 세 가지 방식 모두 신뢰도 95% 기준 p-value 0.05 초과로 귀무가설 채택(대립가설 기각)됨.
#즉, 단측/양측 3가지 case 검정 모두 다이어트 프로그램 수행 전후로 체중 평균 차이가 
#통계적으로 유의미하지 않다는 결론에 도달함
t.test(before, after, alternative = c('less')) #p-value = 0.6218
t.test(before, after, alternative = c('two.sided')) #p-value 0.7563
t.test(before, after, alternative = c('greater')) #p-value = 0.3782

================================================================
2번.
w <- women$weight
h <- women$height

#상관계수
cor(w,h) #상관계수: 0.9954948

#결정계수
R2 <- cor(w,h)^2
R2 #결정계수: 0.9910098
summary(lm(w~h)) #Multiple R-squared:  0.991,	Adjusted R-squared:  0.9903 

#그래프, 회귀직선
model <- lm(w~h)
coef(model) # 회귀계수 (절편: -87.51667, 기울기: 3.45)
plot(h,w)
abline(lm(w~h),col='violet')
abline(h=mean(w), lty=3)
abline(v=mean(h), lty=3)
y = 3.45*x - 87.51667

================================================================
3번. 
# 하기 과정을 모두 거친 뒤, 추적 조사 (시계열 등) 등을 통해 모델의 accuracy를 검증하고
# 지속적으로 hyper-parameter 조정(추가/삭제를 중심으로)과 이상치outlier 조정을 통한 
# 모델 설명의 정확도 상향 및 오차 감소를 통한 모델 최적화 (optimization)를 실현할 필요가 있음

# ------------------------------ a) 변수소거법, 최적의 변수들?
library(MASS)
library(corrplot)
library(car)
library(leaps)

head(state.x77, n=2)
plot(state.x77)

cp <- cor(state.x77)
corrplot.mixed(cp, upper = 'ellipse', 
               lower = 'number')

# Population+Income+Illiteracy+HS.Grad+Frost

state.x77 <- data.frame(state.x77)
state.x77 
m <- lm(Murder~., data=state.x77)
m2 <- regsubsets(Murder~., data=state.x77, method = 'exhaustive')
m3 <- regsubsets(Murder~., data=state.x77, method='backward')
m4 <- regsubsets(Murder~., data=state.x77, method='forward')

plot(m2, scale='adjr2')
plot(m2, scale = 'bic')
plot(m3, scale='adjr2')
plot(m3, scale = 'bic')
plot(m4, scale='adjr2')
plot(m4, scale = 'bic')

# ------------------------------ b) 결정계수 R^2?
cor(state.x77)
R=cor(state.x77)^2
summary(m) #Multiple R-squared:  0.7406,	Adjusted R-squared:  0.7338 

# ------------------------------ c) 회귀모형의 적합성
# 다중공산성 (Variance Inflation Factor) 체크
vif(m)
par(mfrow=c(2,2))
plot(m)
avPlots(m) # 회귀직선 (각 그래프 => X, Y축 상 가장 극단적인 두 점에 대한 라벨)

# 다중회귀분석 (Multiple Regression Analysis)
# 하기 summary 결과 요약 (하기 참조)
# Residual standard error: 3798 on 42 degrees of freedom
# Multiple R-squared:  0.3798,	Adjusted R-squared:  0.2764 
options(scipen = 100)
summary(m)   

cooks.distance(m)

# 회귀모형 적합성 검증을 위해 추가적인 조사/분석이 필요할 것으로 사료됨.
# 즉, residual plot에서의 추가 면밀 분석으로, 특정적으로 존재하는 패턴이 있는지, 
# 분산이 일정한지 등 확인 필요. 
# 보다 자세한 Normality 체크 필요 
# QQ-plot, Shapiro-wilk 테스트에 대한 추가 해석 필요
# outlier 체크 => high leverage 값 존재 여부. 상기 cooks.distance() 함수로
# 구현하였으나, 각 값들에 대한 추가 조사 필요
















